<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>仙人YouTubeビュアー</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;font-family:system-ui;background:#f5f6f8}
header{display:flex;gap:8px;padding:12px;background:#fff;position:sticky;top:0}
input{flex:1;padding:10px;font-size:16px}
button{padding:10px 16px;background:#ff4d4d;color:#fff;border:none;border-radius:8px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:16px;padding:16px}
.card{background:#fff;border-radius:12px;overflow:hidden;cursor:pointer}
.thumb{width:100%;aspect-ratio:16/9;object-fit:cover}
.title{font-weight:bold;font-size:14px;padding:8px}
.author{font-size:12px;color:#666;padding:0 8px 8px}
</style>
</head>
<body>

<header>
  <input id="q" placeholder="動画検索" onkeydown="if(event.key==='Enter')search()">
  <button onclick="search()">検索</button>
</header>

<div id="results" class="grid"></div>

<script>
async function search(){
  const q=document.getElementById("q").value.trim();
  if(!q)return;
  const r=await fetch(`/api/search?q=${encodeURIComponent(q)}`);
  const d=await r.json();
  render(d.results);
}

async function loadTrending(){
  const r=await fetch("/api/trending");
  const d=await r.json();
  render(d.results);
}

function render(list){
  const g=document.getElementById("results");
  g.innerHTML="";
  list.forEach(v=>{
    const c=document.createElement("div");
    c.className="card";
    c.onclick=()=>location.href=`/static/watch.html?v=${v.videoId}`;
    c.innerHTML=`
      <img class="thumb" src="https://i.ytimg.com/vi/${v.videoId}/hqdefault.jpg">
      <div class="title">${v.title}</div>
      <div class="author">${v.author}</div>`;
    g.appendChild(c);
  });
}

loadTrending();
</script>

</body>
</html>
